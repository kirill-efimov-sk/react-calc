var param=false;var story=Array();var pattern=/[0-9]/;var inputElem=document.getElementsByTagName("input");var newElem=document.getElementsByTagName("button");document.addEventListener("keydown",function(e){var val=e.key;if(val=="÷"||val=="/"||val=="×"||val=="*"||val=="+"||val=="-"||val=="."){param=false}if((val=="÷"||val=="/"||val=="×"||val=="*"||val=="+"||val=="-"||val=="."&&val!=="="||val=="Enter"||val.match(/CE|Backspace|C|c|С|с/)||pattern.test(val)==true)&&val.includes("F")==false){main(val.replace("Enter","=").replace("Backspace","CE").replace("С","C").replace("с","C").replace("c","C"))}});document.onclick=function(event){var elem=event.path[0];var val=elem.innerText;if(val=="÷"||val=="/"||val=="×"||val=="*"||val=="+"||val=="-"||val=="."){param=false}if(val!=="history"&&elem.tagName!=="DIV"){main(val)}};function main(value){var operation=inputElem[0].value;font(inputElem);for(i=0;i<19;i++){var y=newElem[i].outerText;newElem[i].classList.remove("active");if(y==value||y.replace("×","*")==value||y.replace("÷","/")==value){newElem[i].classList.add("active");var j=i}}setTimeout(delClass,200,newElem,j);if(value.match(/=|Enter/)){try{if(inputElem[0].value!==""){inputElem[0].value=eval(operation.replace("÷","/").replace("×","*"));story.push(operation.replace("÷","/").replace("×","*")+"="+inputElem[0].value);var storyElem=document.getElementsByClassName("history");if(story.length==3){storyElem[0].textContent=story[2];story.length=0}else if(story.length==1){storyElem[0].textContent=storyElem[0].textContent+","+story;var checkParam=storyElem[0].textContent.slice(0,1);if(checkParam==","){storyElem[0].textContent=storyElem[0].textContent.replace(",","")}}else{storyElem[0].textContent=story}}else{inputElem[0].value=""}param=true}catch{inputElem[0].value=inputElem[0].value}}else if(value.match(/C|c|С|с/)&&value!=="CE"){inputElem[0].value="";inputElem[0].classList.remove("font-micro");inputElem[0].classList.remove("font-min")}else if(value.match(/CE|Backspace/)){inputElem[0].value=operation.substring(0,operation.length-1);font(inputElem)}else{var checkSymbol=pattern.test(value);if(checkSymbol==false&&inputElem[0].value==""){inputElem[0].value="0"+value;return false}if(param==true){if(value=="±"){if(inputElem[0].value.includes("-")==true){inputElem[0].value=inputElem[0].value.replace("-","+")}else if(inputElem[0].value.includes("+")==true){inputElem[0].value=inputElem[0].value.replace("+","-")}}else{inputElem[0].value=value.replace("/","÷").replace("*","×")}param=false}else{if(value=="±"){if(inputElem[0].value.includes("-")==true){inputElem[0].value=inputElem[0].value.replace("-","+")}else if(inputElem[0].value.includes("+")==true){inputElem[0].value=inputElem[0].value.replace("+","-")}}else{var patternNew=/\*|\+|\-|\/|×|÷/;var e=patternNew.test(inputElem[0].value.slice(-1));var strElem=inputElem[0].value.slice(-1);var strLength=inputElem[0].value.length;if(e==true){var subStr=value.replace("÷","/").replace("×","*");var test=inputElem[0].value.slice(0,strLength-1);if(pattern.test(subStr)==false){switch(subStr){case"+":inputElem[0].value=inputElem[0].value.slice(0,strLength-1)+inputElem[0].value.slice(-1).replace(strElem,value);break;case"-":inputElem[0].value=inputElem[0].value.slice(0,strLength-1)+inputElem[0].value.slice(-1).replace(strElem,value);break;case"/":inputElem[0].value=inputElem[0].value.slice(0,strLength-1)+inputElem[0].value.slice(-1).replace(strElem,value);break;case"*":inputElem[0].value=inputElem[0].value.slice(0,strLength-1)+inputElem[0].value.slice(-1).replace(strElem,value);break}}else{inputElem[0].value+=value.replace("/","÷").replace("*","×")}}else{inputElem[0].value+=value.replace("/","÷").replace("*","×")}}}}}function delClass(newElem,j){newElem[j].classList.remove("active")}function font(inputElem){var lengthElem=inputElem[0].value.length;if(lengthElem>13){inputElem[0].classList.add("font-min")}if(lengthElem>18){inputElem[0].classList.remove("font-min");inputElem[0].classList.add("font-micro")}if(lengthElem<13){inputElem[0].classList.remove("font-min");inputElem[0].classList.remove("font-micro")}}